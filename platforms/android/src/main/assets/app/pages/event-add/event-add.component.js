"use strict";
var core_1 = require('@angular/core');
var router_1 = require("@angular/router");
var router_2 = require("@angular/router");
var StackLayout = require("ui/layouts/stack-layout").StackLayout;
var event_handeler_provider_1 = require("../../shared/providers/event-handeler/event-handeler.provider");
var database_1 = require("../../shared/database/database");
var element_registry_1 = require('nativescript-angular/element-registry');
element_registry_1.registerElement('CheckBox', function () { return require('nativescript-checkbox').CheckBox; });
var nativescript_toasty_1 = require('nativescript-toasty');
var TimeDatePicker = require('nativescript-timedatepicker');
var EventAddComponent = (function () {
    function EventAddComponent(route, router, database, eventHandeler) {
        var _this = this;
        this.route = route;
        this.router = router;
        this.database = database;
        this.eventHandeler = eventHandeler;
        this.title = "Computer Science";
        this.description = "description I guess";
        this.icon = -1;
        this.days = [false, false, false, false, false, false, false];
        this.priorityLevel = -1;
        this.startTimeCheck = false;
        this.endTimeCheck = false;
        this.priorityCheck = true;
        this.startTimeStr = "4:00 pm";
        this.endTimeStr = "5:00 pm";
        this.updateEvent = false;
        //----------------------------------
        this.timeDuration = "2:39";
        this.route.queryParams.subscribe(function (params) {
            if (params["key"]) {
                _this.updateEvent = true;
                _this.key = params["key"];
                _this.title = params["title"];
                _this.description = params["description"],
                    _this.priority = params["priority"],
                    _this.startTime = params["startTime"],
                    _this.endTime = params["endTime"];
            } //end of if
        });
        // page = <Page>frame.topmost().currentPage;
    } //end of constructor
    EventAddComponent.prototype.ngOnInit = function () {
    };
    EventAddComponent.prototype.ngAfterViewInit = function () {
        //  let scrollViewIcon: ScrollView = this.scroll.nativeElement;
        //  SwissArmyKnife.removeHorizontalScrollBars(StackLayout);
    };
    EventAddComponent.prototype.doneBtn = function () {
        if (this.title == null) {
            //             let snackbar = new SnackBar();
            //     snackbar.simple('Snackbar').then((args) => {
            //          this.set('jsonResult', JSON.stringify(args));
            //    })
            var toast = new nativescript_toasty_1.Toasty("Please enter a title.", "short", "middle");
            toast.show();
        }
        else if (this.description == null) {
            var toast = new nativescript_toasty_1.Toasty("Please enter a description.", "short");
            toast.show();
        }
        else if (this.priorityLevel == -1) {
            var toast = new nativescript_toasty_1.Toasty("Please enter a priority level.", "short");
            toast.show();
        }
        else if (this.startTimeCheck == false) {
            var toast = new nativescript_toasty_1.Toasty("Please enter a start time.", "short");
            toast.show();
        }
        else if (this.endTimeCheck == false) {
            var toast = new nativescript_toasty_1.Toasty("Please enter an end time.", "short");
            toast.show();
        }
        else if (this.days[0] == false && this.days[1] == false && this.days[2] == false &&
            this.days[3] == false && this.days[4] == false && this.days[5] == false && this.days[6] == false) {
            var toast = new nativescript_toasty_1.Toasty("Please Select what day your event is on.", "short");
            toast.show();
        }
        else {
            if (this.updateEvent == true) {
                this.database.editEvent(this.key, this.title, this.description, this.priorityLevel, this.startTime, this.endTime, this.icon);
            }
            else {
                this.database.newEvent(this.title, this.description, this.priorityLevel, this.startTime, this.endTime, this.icon);
            }
            console.log("priority " + this.priority);
            this.router.navigate(["/home"]);
        } //end of else
    }; //end of method
    EventAddComponent.prototype.initalTime = function () {
        var _this = this;
        var date = new Date();
        var mCallback = (function (result) {
            if (result) {
                date.setHours(Number(result.substring(11, 13)));
                date.setMinutes(Number(result.substring(14, 16)));
                _this.endTime = date;
                _this.startTimeStr = date.getHours() + ":" + date.getMinutes();
                console.log(_this.startTimeStr);
            }
            _this.startTimeCheck = true;
        });
        //Initialize the PickerManager (.init(yourCallback, title, initialDate))
        TimeDatePicker.init(mCallback, null, null);
        //Show the dialog
        TimeDatePicker.showTimePickerDialog();
    }; //end of method
    EventAddComponent.prototype.finalTime = function () {
        var _this = this;
        var date = new Date();
        var mCallback = (function (result) {
            if (result) {
                date.setHours(Number(result.substring(11, 13)));
                date.setMinutes(Number(result.substring(14, 16)));
                _this.startTime = date;
                _this.endTimeStr = date.getHours() + ":" + date.getMinutes();
                console.log(_this.endTimeStr);
            }
            _this.endTimeCheck = true;
        });
        //Initialize the PickerManager (.init(yourCallback, title, initialDate))
        TimeDatePicker.init(mCallback, null, null);
        //Show the dialog
        TimeDatePicker.showTimePickerDialog();
    };
    EventAddComponent.prototype.cancelBtn = function () {
        this.router.navigate(["/home"]);
    };
    EventAddComponent.prototype.priority1 = function () {
        this.priorityLevel = 0;
        // console.log(this.priorityLevel);
    };
    EventAddComponent.prototype.priority2 = function () {
        this.priorityLevel = 1;
        // console.log(this.priorityLevel);
    };
    EventAddComponent.prototype.priority3 = function () {
        this.priorityLevel = 2;
        // console.log(this.priorityLevel);
    };
    EventAddComponent.prototype.monday = function () {
        if (this.days[0] == true) {
            this.days[0] = false;
            console.log("Button tapped now: " + this.days[0]);
        }
        else if (this.days[0] == false) {
            this.days[0] = true;
            console.log("Button tapped now: " + this.days[0]);
        }
    };
    EventAddComponent.prototype.tuesday = function () {
        if (this.days[1] == true) {
            this.days[1] = false;
            console.log("Button tapped now: " + this.days[1]);
        }
        else if (this.days[1] == false) {
            this.days[1] = true;
            console.log("Button tapped now: " + this.days[1]);
        }
    };
    EventAddComponent.prototype.wednesday = function () {
        if (this.days[2] == true) {
            this.days[2] = false;
            console.log("Button tapped now: " + this.days[2]);
        }
        else if (this.days[2] == false) {
            this.days[2] = true;
            console.log("Button tapped now: " + this.days[2]);
        }
    };
    EventAddComponent.prototype.thursday = function () {
        if (this.days[3] == true) {
            this.days[3] = false;
            console.log("Button tapped now: " + this.days[3]);
        }
        else if (this.days[3] == false) {
            this.days[3] = true;
            console.log("Button tapped now: " + this.days[3]);
        }
    };
    EventAddComponent.prototype.friday = function () {
        if (this.days[4] == true) {
            this.days[4] = false;
            console.log("Button tapped now: " + this.days[4]);
        }
        else if (this.days[4] == false) {
            this.days[4] = true;
            console.log("Button tapped now: " + this.days[4]);
        }
    };
    EventAddComponent.prototype.saturday = function () {
        if (this.days[5] == true) {
            this.days[5] = false;
            console.log("Button tapped now: " + this.days[5]);
        }
        else if (this.days[5] == false) {
            this.days[5] = true;
            console.log("Button tapped now: " + this.days[5]);
        }
    };
    EventAddComponent.prototype.sunday = function () {
        if (this.days[6] == true) {
            this.days[6] = false;
            console.log("Button tapped now: " + this.days[6]);
        }
        else if (this.days[6] == false) {
            this.days[6] = true;
            console.log("Button tapped now: " + this.days[6]);
        }
    };
    EventAddComponent.prototype.icon1 = function (iconId) {
        this.icon = iconId;
        console.log("icon " + this.icon + " tapped.");
    };
    __decorate([
        core_1.ViewChild("scroll"), 
        __metadata('design:type', core_1.ElementRef)
    ], EventAddComponent.prototype, "scroll", void 0);
    EventAddComponent = __decorate([
        core_1.Component({
            selector: 'my-app',
            templateUrl: "./pages/event-add/event-add.html",
            styleUrls: ["./pages/event-add/event-add.css"]
        }), 
        __metadata('design:paramtypes', [router_2.ActivatedRoute, router_1.Router, database_1.Database, event_handeler_provider_1.EventHandeler])
    ], EventAddComponent);
    return EventAddComponent;
}());
exports.EventAddComponent = EventAddComponent; //end of Class
/**--------------
 * ----NOTES-----
 * --------------
 *
 * ---Remember---
 * *Go into the fontAwesome file and comment out the icons that are
 * not being used. It takes up space in the application.
 *
 * ---Issues---
 * *If you enter in data into one of the fields and delete it,
 * it the property in the Typescript is no longer NULL and doesn't,
 * get cought by the 'if(null)' check
 */ 
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZlbnQtYWRkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImV2ZW50LWFkZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHFCQUF5RCxlQUFlLENBQUMsQ0FBQTtBQUN6RSx1QkFBdUIsaUJBQWlCLENBQUMsQ0FBQTtBQUN6Qyx1QkFBK0IsaUJBQWlCLENBQUMsQ0FBQTtBQUdqRCxJQUFJLFdBQVcsR0FBRyxPQUFPLENBQUMseUJBQXlCLENBQUMsQ0FBQyxXQUFXLENBQUM7QUFFakUsd0NBQThCLCtEQUErRCxDQUFDLENBQUE7QUFFOUYseUJBQXlCLGdDQUFnQyxDQUFDLENBQUE7QUFFMUQsaUNBQWdDLHVDQUF1QyxDQUFDLENBQUE7QUFDeEUsa0NBQWUsQ0FBQyxVQUFVLEVBQUUsY0FBTSxPQUFBLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLFFBQVEsRUFBekMsQ0FBeUMsQ0FBQyxDQUFDO0FBSTdFLG9DQUF1QixxQkFDdkIsQ0FBQyxDQUQyQztBQUU1QyxJQUFZLGNBQWMsV0FBTSw2QkFBNkIsQ0FBQyxDQUFBO0FBVzlEO0lBK0JJLDJCQUFvQixLQUFxQixFQUFVLE1BQWMsRUFDckQsUUFBa0IsRUFBVSxhQUE0QjtRQWhDeEUsaUJBa1FDO1FBbk91QixVQUFLLEdBQUwsS0FBSyxDQUFnQjtRQUFVLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDckQsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUFVLGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBN0JwRSxVQUFLLEdBQVcsa0JBQWtCLENBQUM7UUFDbkMsZ0JBQVcsR0FBVyxxQkFBcUIsQ0FBQztRQUc1QyxTQUFJLEdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDbEIsU0FBSSxHQUFjLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDcEUsa0JBQWEsR0FBVyxDQUFD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a0M7WUFDL0MsU0FBUyxFQUFFLENBQUMsaUNBQWlDLENBQUM7U0FDakQsQ0FBQzs7eUJBQUE7SUFtUUYsd0JBQUM7QUFBRCxDQUFDLEFBbFFELElBa1FDO0FBbFFZLHlCQUFpQixvQkFrUTdCLENBQUEsQ0FBQSxjQUFjO0FBR2Y7Ozs7Ozs7Ozs7OztHQVlHIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEVsZW1lbnRSZWYsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tIFwiQGFuZ3VsYXIvcm91dGVyXCI7XHJcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlIH0gZnJvbSBcIkBhbmd1bGFyL3JvdXRlclwiO1xyXG5pbXBvcnQgeyBQYWdlIH0gZnJvbSBcInVpL3BhZ2VcIjtcclxuaW1wb3J0IGZyYW1lID0gcmVxdWlyZShcInVpL2ZyYW1lXCIpO1xyXG52YXIgU3RhY2tMYXlvdXQgPSByZXF1aXJlKFwidWkvbGF5b3V0cy9zdGFjay1sYXlvdXRcIikuU3RhY2tMYXlvdXQ7XHJcblxyXG5pbXBvcnQgeyBFdmVudEhhbmRlbGVyIH0gZnJvbSBcIi4uLy4uL3NoYXJlZC9wcm92aWRlcnMvZXZlbnQtaGFuZGVsZXIvZXZlbnQtaGFuZGVsZXIucHJvdmlkZXJcIjtcclxuaW1wb3J0IHsgSG9tZUNvbXBvbmVudCB9IGZyb20gXCIuLi9ob21lL2hvbWUuY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IERhdGFiYXNlIH0gZnJvbSBcIi4uLy4uL3NoYXJlZC9kYXRhYmFzZS9kYXRhYmFzZVwiO1xyXG5cclxuaW1wb3J0IHsgcmVnaXN0ZXJFbGVtZW50IH0gZnJvbSAnbmF0aXZlc2NyaXB0LWFuZ3VsYXIvZWxlbWVudC1yZWdpc3RyeSc7XHJcbnJlZ2lzdGVyRWxlbWVudCgnQ2hlY2tCb3gnLCAoKSA9PiByZXF1aXJlKCduYXRpdmVzY3JpcHQtY2hlY2tib3gnKS5DaGVja0JveCk7XHJcblxyXG5pbXBvcnQgeyBTd2lzc0FybXlLbmlmZSB9IGZyb20gJ25hdGl2ZXNjcmlwdC1zd2lzcy1hcm15LWtuaWZlL25hdGl2ZXNjcmlwdC1zd2lzcy1hcm15LWtuaWZlJztcclxuXHJcbmltcG9ydCB7IFRvYXN0eSB9IGZyb20gJ25hdGl2ZXNjcmlwdC10b2FzdHknXHJcbmltcG9ydCB7IFNuYWNrQmFyLCBTbmFja0Jhck9wdGlvbnMgfSBmcm9tIFwibmF0aXZlc2NyaXB0LXNuYWNrYmFyXCI7XHJcbmltcG9ydCAqIGFzIFRpbWVEYXRlUGlja2VyIGZyb20gJ25hdGl2ZXNjcmlwdC10aW1lZGF0ZXBpY2tlcic7XHJcbmltcG9ydCB7IERhdGVQaWNrZXIgfSBmcm9tIFwidWkvZGF0ZS1waWNrZXJcIjtcclxuaW1wb3J0IHsgU2Nyb2xsVmlldywgU2Nyb2xsRXZlbnREYXRhIH0gZnJvbSAndWkvc2Nyb2xsLXZpZXcnO1xyXG5pbXBvcnQgeyBMaXN0VmlldyB9IGZyb20gJ3VpL2xpc3Qtdmlldyc7XHJcblxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ215LWFwcCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogXCIuL3BhZ2VzL2V2ZW50LWFkZC9ldmVudC1hZGQuaHRtbFwiLFxyXG4gICAgc3R5bGVVcmxzOiBbXCIuL3BhZ2VzL2V2ZW50LWFkZC9ldmVudC1hZGQuY3NzXCJdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBFdmVudEFkZENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gICAga2V5OiBzdHJpbmc7XHJcbiAgICB0aXRsZTogc3RyaW5nID0gXCJDb21wdXRlciBTY2llbmNlXCI7XHJcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nID0gXCJkZXNjcmlwdGlvbiBJIGd1ZXNzXCI7XHJcbiAgICBzdGFydFRpbWU6IERhdGU7XHJcbiAgICBlbmRUaW1lOiBEYXRlO1xyXG4gICAgaWNvbjogbnVtYmVyID0gLTE7XHJcbiAgICBkYXlzOiBib29sZWFuW10gPSBbZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2VdO1xyXG4gICAgcHJpb3JpdHlMZXZlbDogbnVtYmVyID0gLTE7XHJcblxyXG4gICAgcHJpb3JpdHk6IG51bWJlcjtcclxuXHJcblxyXG4gICAgc3RhcnRUaW1lQ2hlY2s6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGVuZFRpbWVDaGVjazogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpb3JpdHlDaGVjazogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gICAgc3RhcnRUaW1lU3RyID0gXCI0OjAwIHBtXCI7XHJcbiAgICBlbmRUaW1lU3RyID0gXCI1OjAwIHBtXCI7XHJcblxyXG4gICAgdXBkYXRlRXZlbnQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHRpbWVEdXJhdGlvbjogc3RyaW5nID0gXCIyOjM5XCI7XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBAVmlld0NoaWxkKFwic2Nyb2xsXCIpIHNjcm9sbDogRWxlbWVudFJlZjtcclxuXHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcm91dGU6IEFjdGl2YXRlZFJvdXRlLCBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxyXG4gICAgICAgIHByaXZhdGUgZGF0YWJhc2U6IERhdGFiYXNlLCBwcml2YXRlIGV2ZW50SGFuZGVsZXI6IEV2ZW50SGFuZGVsZXIpIHtcclxuICAgICAgICB0aGlzLnJvdXRlLnF1ZXJ5UGFyYW1zLnN1YnNjcmliZShwYXJhbXMgPT4ge1xyXG4gICAgICAgICAgICBpZiAocGFyYW1zW1wia2V5XCJdKSB7Ly9GT1IgQVVUTyBGSUxMIEZPUiBNQUtJTkcgTkVXIEVWRU5ULiBET05UIEZPUkdFVCBUTyBERUxFVEUgVEhJUyEhIVxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFdmVudCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleSA9IHBhcmFtc1tcImtleVwiXTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGl0bGUgPSBwYXJhbXNbXCJ0aXRsZVwiXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBwYXJhbXNbXCJkZXNjcmlwdGlvblwiXSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaW9yaXR5ID0gcGFyYW1zW1wicHJpb3JpdHlcIl0sXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSBwYXJhbXNbXCJzdGFydFRpbWVcIl0sXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRUaW1lID0gcGFyYW1zW1wiZW5kVGltZVwiXVxyXG4gICAgICAgICAgICB9Ly9lbmQgb2YgaWZcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gcGFnZSA9IDxQYWdlPmZyYW1lLnRvcG1vc3QoKS5jdXJyZW50UGFnZTtcclxuICAgIH0vL2VuZCBvZiBjb25zdHJ1Y3RvclxyXG5cclxuXHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgICAgICAvLyAgbGV0IHNjcm9sbFZpZXdJY29uOiBTY3JvbGxWaWV3ID0gdGhpcy5zY3JvbGwubmF0aXZlRWxlbWVudDtcclxuICAgICAgICAvLyAgU3dpc3NBcm15S25pZmUucmVtb3ZlSG9yaXpvbnRhbFNjcm9sbEJhcnMoU3RhY2tMYXlvdXQpO1xyXG4gICAgfVxyXG5cclxuICAgIGRvbmVCdG4oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudGl0bGUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICBsZXQgc25hY2tiYXIgPSBuZXcgU25hY2tCYXIoKTtcclxuICAgICAgICAgICAgLy8gICAgIHNuYWNrYmFyLnNpbXBsZSgnU25hY2tiYXInKS50aGVuKChhcmdzKSA9PiB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgIHRoaXMuc2V0KCdqc29uUmVzdWx0JywgSlNPTi5zdHJpbmdpZnkoYXJncykpO1xyXG4gICAgICAgICAgICAvLyAgICB9KVxyXG4gICAgICAgICAgICBjb25zdCB0b2FzdCA9IG5ldyBUb2FzdHkoXCJQbGVhc2UgZW50ZXIgYSB0aXRsZS5cIiwgXCJzaG9ydFwiLCBcIm1pZGRsZVwiKTtcclxuICAgICAgICAgICAgdG9hc3Quc2hvdygpO1xyXG4gICAgICAgICAgICAvLyBhbGVydChcIlBsZWFzZSBlbnRlciBhIHRpdGxlLlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5kZXNjcmlwdGlvbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvYXN0ID0gbmV3IFRvYXN0eShcIlBsZWFzZSBlbnRlciBhIGRlc2NyaXB0aW9uLlwiLCBcInNob3J0XCIpO1xyXG4gICAgICAgICAgICB0b2FzdC5zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMucHJpb3JpdHlMZXZlbCA9PSAtMSkge1xyXG4gICAgICAgICAgICBjb25zdCB0b2FzdCA9IG5ldyBUb2FzdHkoXCJQbGVhc2UgZW50ZXIgYSBwcmlvcml0eSBsZXZlbC5cIiwgXCJzaG9ydFwiKTtcclxuICAgICAgICAgICAgdG9hc3Quc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLnN0YXJ0VGltZUNoZWNrID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvYXN0ID0gbmV3IFRvYXN0eShcIlBsZWFzZSBlbnRlciBhIHN0YXJ0IHRpbWUuXCIsIFwic2hvcnRcIik7XHJcbiAgICAgICAgICAgIHRvYXN0LnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5lbmRUaW1lQ2hlY2sgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29uc3QgdG9hc3QgPSBuZXcgVG9hc3R5KFwiUGxlYXNlIGVudGVyIGFuIGVuZCB0aW1lLlwiLCBcInNob3J0XCIpO1xyXG4gICAgICAgICAgICB0b2FzdC5zaG93KCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmRheXNbMF0gPT0gZmFsc2UgJiYgdGhpcy5kYXlzWzFdID09IGZhbHNlICYmIHRoaXMuZGF5c1syXSA9PSBmYWxzZSAmJlxyXG4gICAgICAgICAgICB0aGlzLmRheXNbM10gPT0gZmFsc2UgJiYgdGhpcy5kYXlzWzRdID09IGZhbHNlICYmIHRoaXMuZGF5c1s1XSA9PSBmYWxzZSAmJiB0aGlzLmRheXNbNl0gPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29uc3QgdG9hc3QgPSBuZXcgVG9hc3R5KFwiUGxlYXNlIFNlbGVjdCB3aGF0IGRheSB5b3VyIGV2ZW50IGlzIG9uLlwiLCBcInNob3J0XCIpO1xyXG4gICAgICAgICAgICB0b2FzdC5zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy51cGRhdGVFdmVudCA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFiYXNlLmVkaXRFdmVudChcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmtleSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmlvcml0eUxldmVsLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kVGltZSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmljb24sXHJcblxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YWJhc2UubmV3RXZlbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aXRsZSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpb3JpdHlMZXZlbCxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0VGltZSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZFRpbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pY29uLFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInByaW9yaXR5IFwiICsgdGhpcy5wcmlvcml0eSk7XHJcbiAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcIi9ob21lXCJdKTtcclxuXHJcbiAgICAgICAgfS8vZW5kIG9mIGVsc2VcclxuXHJcbiAgICB9Ly9lbmQgb2YgbWV0aG9kXHJcblxyXG4gICAgcHJpdmF0ZSBpbml0YWxUaW1lKCkge1xyXG4gICAgICAgIGxldCBkYXRlOiBEYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICBsZXQgbUNhbGxiYWNrID0gKChyZXN1bHQ6IFN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgZGF0ZS5zZXRIb3VycyhOdW1iZXIocmVzdWx0LnN1YnN0cmluZygxMSwgMTMpKSk7XHJcbiAgICAgICAgICAgICAgICBkYXRlLnNldE1pbnV0ZXMoTnVtYmVyKHJlc3VsdC5zdWJzdHJpbmcoMTQsIDE2KSkpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuZW5kVGltZSA9IGRhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0VGltZVN0ciA9IGRhdGUuZ2V0SG91cnMoKSArIFwiOlwiICsgZGF0ZS5nZXRNaW51dGVzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5zdGFydFRpbWVTdHIpO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0VGltZUNoZWNrID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL0luaXRpYWxpemUgdGhlIFBpY2tlck1hbmFnZXIgKC5pbml0KHlvdXJDYWxsYmFjaywgdGl0bGUsIGluaXRpYWxEYXRlKSlcclxuICAgICAgICBUaW1lRGF0ZVBpY2tlci5pbml0KG1DYWxsYmFjaywgbnVsbCwgbnVsbCk7XHJcblxyXG4gICAgICAgIC8vU2hvdyB0aGUgZGlhbG9nXHJcbiAgICAgICAgVGltZURhdGVQaWNrZXIuc2hvd1RpbWVQaWNrZXJEaWFsb2coKTtcclxuICAgIH0vL2VuZCBvZiBtZXRob2RcclxuXHJcbiAgICBwcml2YXRlIGZpbmFsVGltZSgpIHtcclxuICAgICAgICBsZXQgZGF0ZTogRGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgbGV0IG1DYWxsYmFjayA9ICgocmVzdWx0OiBTdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgZGF0ZS5zZXRIb3VycyhOdW1iZXIocmVzdWx0LnN1YnN0cmluZygxMSwgMTMpKSk7XHJcbiAgICAgICAgICAgICAgICBkYXRlLnNldE1pbnV0ZXMoTnVtYmVyKHJlc3VsdC5zdWJzdHJpbmcoMTQsIDE2KSkpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lID0gZGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW5kVGltZVN0ciA9IGRhdGUuZ2V0SG91cnMoKSArIFwiOlwiICsgZGF0ZS5nZXRNaW51dGVzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5lbmRUaW1lU3RyKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5lbmRUaW1lQ2hlY2sgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vSW5pdGlhbGl6ZSB0aGUgUGlja2VyTWFuYWdlciAoLmluaXQoeW91ckNhbGxiYWNrLCB0aXRsZSwgaW5pdGlhbERhdGUpKVxyXG4gICAgICAgIFRpbWVEYXRlUGlja2VyLmluaXQobUNhbGxiYWNrLCBudWxsLCBudWxsKTtcclxuXHJcbiAgICAgICAgLy9TaG93IHRoZSBkaWFsb2dcclxuICAgICAgICBUaW1lRGF0ZVBpY2tlci5zaG93VGltZVBpY2tlckRpYWxvZygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNhbmNlbEJ0bigpIHtcclxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCIvaG9tZVwiXSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgcHJpb3JpdHkxKCkge1xyXG4gICAgICAgIHRoaXMucHJpb3JpdHlMZXZlbCA9IDA7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5wcmlvcml0eUxldmVsKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHByaW9yaXR5MigpIHtcclxuICAgICAgICB0aGlzLnByaW9yaXR5TGV2ZWwgPSAxO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucHJpb3JpdHlMZXZlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBwcmlvcml0eTMoKSB7XHJcbiAgICAgICAgdGhpcy5wcmlvcml0eUxldmVsID0gMjtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnByaW9yaXR5TGV2ZWwpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIG1vbmRheSgpIHtcclxuICAgICAgICBpZiAodGhpcy5kYXlzWzBdID09IHRydWUpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXlzWzBdID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnV0dG9uIHRhcHBlZCBub3c6IFwiICsgdGhpcy5kYXlzWzBdKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGF5c1swXSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRheXNbMF0gPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkJ1dHRvbiB0YXBwZWQgbm93OiBcIiArIHRoaXMuZGF5c1swXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdHVlc2RheSgpIHtcclxuICAgICAgICBpZiAodGhpcy5kYXlzWzFdID09IHRydWUpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXlzWzFdID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnV0dG9uIHRhcHBlZCBub3c6IFwiICsgdGhpcy5kYXlzWzFdKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGF5c1sxXSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRheXNbMV0gPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkJ1dHRvbiB0YXBwZWQgbm93OiBcIiArIHRoaXMuZGF5c1sxXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgd2VkbmVzZGF5KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRheXNbMl0gPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRheXNbMl0gPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJCdXR0b24gdGFwcGVkIG5vdzogXCIgKyB0aGlzLmRheXNbMl0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kYXlzWzJdID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF5c1syXSA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnV0dG9uIHRhcHBlZCBub3c6IFwiICsgdGhpcy5kYXlzWzJdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB0aHVyc2RheSgpIHtcclxuICAgICAgICBpZiAodGhpcy5kYXlzWzNdID09IHRydWUpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXlzWzNdID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnV0dG9uIHRhcHBlZCBub3c6IFwiICsgdGhpcy5kYXlzWzNdKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGF5c1szXSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRheXNbM10gPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkJ1dHRvbiB0YXBwZWQgbm93OiBcIiArIHRoaXMuZGF5c1szXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZnJpZGF5KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRheXNbNF0gPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRheXNbNF0gPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJCdXR0b24gdGFwcGVkIG5vdzogXCIgKyB0aGlzLmRheXNbNF0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kYXlzWzRdID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF5c1s0XSA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnV0dG9uIHRhcHBlZCBub3c6IFwiICsgdGhpcy5kYXlzWzRdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzYXR1cmRheSgpIHtcclxuICAgICAgICBpZiAodGhpcy5kYXlzWzVdID09IHRydWUpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXlzWzVdID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnV0dG9uIHRhcHBlZCBub3c6IFwiICsgdGhpcy5kYXlzWzVdKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGF5c1s1XSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRheXNbNV0gPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkJ1dHRvbiB0YXBwZWQgbm93OiBcIiArIHRoaXMuZGF5c1s1XSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3VuZGF5KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRheXNbNl0gPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRheXNbNl0gPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJCdXR0b24gdGFwcGVkIG5vdzogXCIgKyB0aGlzLmRheXNbNl0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kYXlzWzZdID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF5c1s2XSA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnV0dG9uIHRhcHBlZCBub3c6IFwiICsgdGhpcy5kYXlzWzZdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpY29uMShpY29uSWQpIHtcclxuICAgICAgICB0aGlzLmljb24gPSBpY29uSWQ7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJpY29uIFwiICsgdGhpcy5pY29uICsgXCIgdGFwcGVkLlwiKTtcclxuICAgIH1cclxufS8vZW5kIG9mIENsYXNzXHJcblxyXG5cclxuLyoqLS0tLS0tLS0tLS0tLS1cclxuICogLS0tLU5PVEVTLS0tLS1cclxuICogLS0tLS0tLS0tLS0tLS1cclxuICogXHJcbiAqIC0tLVJlbWVtYmVyLS0tXHJcbiAqICpHbyBpbnRvIHRoZSBmb250QXdlc29tZSBmaWxlIGFuZCBjb21tZW50IG91dCB0aGUgaWNvbnMgdGhhdCBhcmVcclxuICogbm90IGJlaW5nIHVzZWQuIEl0IHRha2VzIHVwIHNwYWNlIGluIHRoZSBhcHBsaWNhdGlvbi5cclxuICogXHJcbiAqIC0tLUlzc3Vlcy0tLVxyXG4gKiAqSWYgeW91IGVudGVyIGluIGRhdGEgaW50byBvbmUgb2YgdGhlIGZpZWxkcyBhbmQgZGVsZXRlIGl0LFxyXG4gKiBpdCB0aGUgcHJvcGVydHkgaW4gdGhlIFR5cGVzY3JpcHQgaXMgbm8gbG9uZ2VyIE5VTEwgYW5kIGRvZXNuJ3QsXHJcbiAqIGdldCBjb3VnaHQgYnkgdGhlICdpZihudWxsKScgY2hlY2tcclxuICovIl19